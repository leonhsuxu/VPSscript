name: Download YAML File (Windows CMD)

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  download:
    runs-on: windows-latest  # 使用 Windows 环境
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
    
    - name: Download using CMD
      shell: cmd  # 指定使用 CMD
      run: |
        echo 当前目录: %CD%
        curl "https://pastecode.dev/raw/hntbocnp/健康中心618ord" > HeathCloud618ord.yaml
        dir HeathCloud618ord.yaml
    
    - name: Display file content
      shell: cmd
      run: type HeathCloud618ord.yaml
    
    - name: Commit and push if changed
      shell: cmd
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add HeathCloud618ord.yaml
        git diff --quiet && git diff --staged --quiet || (git commit -m "Update HeathCloud618ord.yaml" && git push)
