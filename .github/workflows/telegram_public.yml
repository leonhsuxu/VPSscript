name: Telegram Channel Link Scraper # 工作流名称可以保持不变或更改

on:
  schedule:
    - cron: '0 */2 * * *'
  workflow_dispatch:

jobs:
  scrape_telegram_links:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.x'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install telethon

    - name: Run Telegram scraper script
      env:
        TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
        TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
        TELEGRAM_STRING_SESSION: ${{ secrets.TELEGRAM_STRING_SESSION }}
        TELEGRAM_CHANNEL_USERNAME: "@your_telegram_channel_username_or_id" # 替换为您的频道用户名或ID
      run: |
        # *** 关键修改：脚本路径现在是 Telegram/telegram_publiclink.py ***
        python Telegram/telegram_publiclink.py

    - name: Commit and push changes
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: "自动更新：Telegram 频道订阅链接"
        file_pattern: "flclashyaml/telegram_publiclink.txt" # 保持与之前设置的输出文件路径一致
