# .github/workflows/Telegram_PublicLink.yml
name: ğŸ†˜ TelegramLink æŠ“å–

on:
  schedule:
    - cron: '0 */4 * * *' # æ¯4å°æ—¶è¿è¡Œä¸€æ¬¡ (UTCæ—¶é—´)
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ

jobs:
  scrape_telegram_links:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.x'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install telethon

    - name: Run Telegram scraper script
      env:
        #
        # === ä»¥ä¸‹æ˜¯é¢‘é“/ç¾¤ç»„IDåˆ—è¡¨ï¼Œè¯·åœ¨æ­¤å¤„ä¿®æ”¹ ===
        # æ¯ä¸ªIDå ä¸€è¡Œï¼Œå¯ä»¥æ˜¯ç”¨æˆ·åï¼ˆä¾‹å¦‚ @mychannelï¼‰æˆ–æ•°å­—IDï¼ˆä¾‹å¦‚ -1001234567890ï¼‰ã€‚
        # å¦‚æœæ˜¯æ•°å­—IDï¼Œç¡®ä¿æ‚¨çš„Telegramè´¦æˆ·æ˜¯è¯¥é¢‘é“/ç¾¤ç»„çš„æˆå‘˜ã€‚
        # é»˜è®¤ç¤ºä¾‹å·²åŒ…å«æ‚¨æä¾›çš„ ID å’Œå…¶ä»–ä¸¤ä¸ªå ä½ç¬¦ã€‚
        #
        TELEGRAM_CHANNEL_IDS: |
          @fqDINYUE  #-1002452753229
          #-1002452754444 # ç¤ºä¾‹ï¼šæ–°å¢é¢‘é“1
          #-1002452754445 # ç¤ºä¾‹ï¼šæ–°å¢é¢‘é“2
          # åœ¨æ­¤å¤„æ·»åŠ æ›´å¤šé¢‘é“IDï¼Œæ¯ä¸ªä¸€è¡Œ
        #
        # === é¢‘é“/ç¾¤ç»„IDåˆ—è¡¨ç»“æŸ ===
        #
        TELEGRAM_API_ID: ${{ secrets.TELEGRAM_API_ID }}
        TELEGRAM_API_HASH: ${{ secrets.TELEGRAM_API_HASH }}
        TELEGRAM_STRING_SESSION: ${{ secrets.TELEGRAM_STRING_SESSION }}
      run: |
        python TelegramNode/telegram_publiclink.py

    - name: Commit and push changes
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: "è‡ªåŠ¨æ›´æ–°ï¼šTelegram é¢‘é“è®¢é˜…é“¾æ¥"
        file_pattern: "flclashyaml/telegram_publiclink.txt"
